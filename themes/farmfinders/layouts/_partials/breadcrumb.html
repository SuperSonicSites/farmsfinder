{{ $currentPath := .RelPermalink }}
{{ $pathParts := split (trim $currentPath "/") "/" }}

{{ if gt (len $pathParts) 0 }}
<nav aria-label="breadcrumb" class="mb-6">
  <ol style="display: flex; list-style: none; padding: 0; margin: 0; gap: 0.5rem; align-items: center;">
    <li style="position: relative;"><a href="/">Home</a><span style="margin-left: 0.5rem;">></span></li>
    
    {{ if eq (len $pathParts) 1 }}
      <li aria-current="page">{{ if .Title }}{{ .Title }}{{ else }}{{ index $pathParts 0 | replace "-" " " | title }}{{ end }}</li>
    {{ else if eq (len $pathParts) 2 }}
      {{ $parentPath := printf "/%s/" (index $pathParts 0) }}
      {{ $parentPage := site.GetPage $parentPath }}
      {{ $parentTitle := "" }}
      {{ if $parentPage }}
        {{ $parentTitle = $parentPage.Title }}
      {{ else }}
        {{ $parentTitle = index $pathParts 0 | replace "-" " " | title }}
      {{ end }}
      <li style="position: relative;"><a href="{{ $parentPath }}">{{ $parentTitle }}</a><span style="margin-left: 0.5rem;">></span></li>
      <li aria-current="page">{{ if .Title }}{{ .Title }}{{ else }}{{ index $pathParts 1 | replace "-" " " | title }}{{ end }}</li>
    {{ else if eq (len $pathParts) 3 }}
      {{ $grandparentPath := printf "/%s/" (index $pathParts 0) }}
      {{ $parentPath := printf "/%s/%s/" (index $pathParts 0) (index $pathParts 1) }}
      {{ $grandparentPage := site.GetPage $grandparentPath }}
      {{ $parentPage := site.GetPage $parentPath }}
      
      {{ $grandparentTitle := "" }}
      {{ if $grandparentPage }}
        {{ $grandparentTitle = $grandparentPage.Title }}
      {{ else }}
        {{ $grandparentTitle = index $pathParts 0 | replace "-" " " | title }}
      {{ end }}
      
      {{ $parentTitle := "" }}
      {{ if $parentPage }}
        {{ $parentTitle = $parentPage.Title }}
      {{ else }}
        {{ $parentTitle = index $pathParts 1 | replace "-" " " | title }}
      {{ end }}
      
      <li style="position: relative;"><a href="{{ $grandparentPath }}">{{ $grandparentTitle }}</a><span style="margin-left: 0.5rem;">></span></li>
      <li style="position: relative;"><a href="{{ $parentPath }}">{{ $parentTitle }}</a><span style="margin-left: 0.5rem;">></span></li>
      <li aria-current="page">{{ if .Title }}{{ .Title }}{{ else }}{{ index $pathParts 2 | replace "-" " " | title }}{{ end }}</li>
    {{ end }}
  </ol>
</nav>
{{ end }}
