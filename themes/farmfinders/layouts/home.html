{{ define "title" }}{{ .Site.Title }} - Find Farms Across Canada{{ end }}

{{ define "main" }}
  <article>
    <header>
      <h1>{{ .Title }}</h1>
      {{ .Content }}
    </header>
    
    <section aria-labelledby="categories-heading">
      <h2 id="categories-heading">Browse by Category</h2>
      
      {{ $categories := slice }}
      {{ range where site.RegularPages "Section" "farms" }}
        {{ range .Params.categories }}
          {{ if not (in $categories .) }}
            {{ $categories = $categories | append . }}
          {{ end }}
        {{ end }}
      {{ end }}
      
      <nav aria-label="Farm categories">
        <ul>
        {{ range $categories }}
          {{ $categoryPath := printf "/%s/" (. | urlize) }}
          {{ $categoryPage := site.GetPage $categoryPath }}
          <li>
            <a href="{{ $categoryPath }}">
              {{ if $categoryPage }}{{ $categoryPage.Title }}{{ else }}{{ . | title }}{{ end }}
            </a>
          </li>
        {{ end }}
        </ul>
      </nav>
    </section>
  </article>

  {{ partial "schema.html" . }}
{{ end }}
